/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var e=function(){return(e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function t(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,c=i.length;a<c;a++,o++)r[o]=i[a];return r}var n=window;var r={};function o(e){var t=typeof e;return"object"===t?r[Object.prototype.toString.call(e)]:t}function i(e){return"number"===o(e)}function a(e){return"string"===o(e)}function c(e){return Array.isArray(e)}function u(e){return"boolean"===o(e)}function s(e){return"object"===o(e)}function l(e){return"function"===o(e)}["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error","HTMLCollection"].map((function(e){r["[object "+e+"]"]=e.toLowerCase()}));var f=["$lib","$lib_version","$platform","$first_visit_time","$debug","$is_login"],d=["$lib","$lib_version","$platform","$is_login","$debug"],p=["$screen_width","$screen_height","$language","$time_zone","$session_id","$is_time_calibrated","$web_crawler","$user_agent","$title","$url","$is_first_day","$utm_campaign_id","$utm_campaign","$utm_medium","$utm_source","$utm_content","$utm_term"],g=["$element_type","$element_path","$element_content","$element_id","$element_name","$element_target_url","$element_class_name","$device_type","$url_path"],m={$startup:t(p,["$is_first_time"]),$end:t(p,["$duration"]),$pageview:t(p,["$url_domain","$referrer","$referrer_domain","$startup_time"]),page_close:t(p,["$referrer","pagestaytime"]),$user_click:t(g,p),$web_click:t(p,g,["$page_width","$page_height","$click_x","$click_y","$element_x","$element_y","$element_clickable"]),$webstay:t(p,["$referrer","$referrer_domain","$viewport_width","$viewport_position","$viewport_height","$event_duration","$device_type"]),track:t(p),$profile_set_once:["$first_visit_time","$first_visit_language"],$alias:["$original_id"],$getPresetProperties:t(d,p,["$first_visit_time"])};function h(e){return"{FN}:Property value invalid of key[{KEY}], support type: "+e+"\n\tcurrent value: {VALUE}\n\tcurrent type: {VALUETYPE}"}var v={common:"",60001:h("String"),60002:h("Number"),60003:h("Boolean"),60004:h("Function"),60005:"{FN}:The length of the property[{KEY}] value (string[{VALUE}]) needs to be 1-255 !",60006:"Please set appkey first.",60007:"Please set uploadURL first.",60008:"Send message failed.",60009:"{FN}:The length of the property key (string[{KEY}]) needs to be 1-125 !",600010:"{FN}:The length of the property key (string[{KEY}]) needs to be 1-99 !",600012:"{FN}:Property key invalid, nonsupport value: "+f.join("/")+" \ncurrent KEY:{KEY}",600016:"{FN}: Property value invalid, support type: Object \ncurrent value:{VALUE}\ncurrent type: {VALUETYPE}",600020:"DebugMode only can be 0,1,2",600022:"{FN}: 属性[{KEY}]的值[{VALUE}]无效，支持类型：String/Number/Boolean/string[]，若为字符串，长度范围1-255字符",600023:"{FN}: 属性key的名称[{KEY}]无效，属性key是以字母开头的字符串，由字母、数字、下划线组成，字母不区分大小写，不支持乱码、中文、空格等，长度范围1-99字符；",600025:"{FN}: 事件名称[{VALUE}]无效，事件ID必须字母或者$开头，可包含数字字母与下划线，1-99个字符；"},y={common:"",20001:"Send message success",20002:"{FN}: set success ({VALUE})",20003:"{FN}:({VALUE}) delete success",20004:"{FN}:clear success",20005:"{FN}:reset success",20006:"set appkey success. current appkey : {VALUE}",20007:"Init Analysysdata JS sdk success, version : 5.0.5",20008:"set uploadURL success. current uploadURL : {VALUE}",20009:"{FN}:[{KEY}] : get failed",20010:"{FN}:[{KEY}] : get success. ({VALUE})",20011:"{FN}:({VALUE}) delete failed",20012:"Send Message to Server: {KEY} \ndata:{VALUE}",20013:"收到服务器的时间: {VALUE} \n本地时间: {KEY} \n时间相差:  {FN} \n数据将会进行时间校准",20014:"aliasID already bound"};function _(e){if(1===Jt.debugMode||2===Jt.debugMode){var t=(y[e.code]||y.common).replace(/{FN}/,e.fn).replace(/{KEY}/g,e.key||"").replace(/{VALUE}/g,JSON.stringify(e.value));console.log(t)}}function x(e,t){var n=(v[e.code]||v.common).replace(/{FN}/g,e.fn||"").replace(/{KEY}/g,JSON.stringify(e.key||"")).replace(/{VALUE}/g,JSON.stringify(e.value)).replace(/{VALUETYPE}/g,o(e.value)).replace(/{KEYTYPE}/g,o(e.key));(1===Jt.debugMode||2===Jt.debugMode||t)&&console.warn(n)}function S(e){console.log(e)}function w(e,t,n){if(void 0===t&&(t=255),void 0===n&&(n=1),!a(e))return!1;var r=e.length;return r<=t&&r>=n}function A(e,t){var n=!0;return w(e,99)?f.indexOf(e)>-1?(n=!1,t&&(t.code=600012)):n=/^[$a-zA-Z][a-zA-Z0-9_$]{0,}$/.test(e):n=!1,t&&t.fn&&!n&&x(t),n}function $(e,t){var n=!1;if(a(e)||i(e)||c(e)||u(e))if(n=!0,a(e))w(e,255)||(n=!1);else if(c(e)){n=e.some((function(e){return w(e,255)}))}return t&&t.fn&&t.key&&!n&&x(t),n}function b(e,t){var n={};if(!s(e))return x({code:600016,fn:t,value:e}),{};for(var r in e){var o=l(e[r])?e[r]():e[r];A(r,{code:600023,fn:t,key:r})&&$(o,{code:600022,fn:t,key:r,value:o})&&(n[r]=o)}return n}function T(e,t,n){x({key:e,code:n,value:t},!0)}function k(e,t){var n=u(e);return n||T(t,e,60003),n}function E(e,t){var n=l(e);return n||T(t,e,60004),n}function R(e,t){var n=i(e);return n||T(t,e,60002),n}function O(e,t){var n=a(e);return n||T(t,e,60001),n}function D(e,t){var n=s(e);return n||T(t,e,600016),n}function C(e,t){if(e){var n=window.location;if(a(e)){var r=n.href,o=n.protocol+"//"+n.host,i=o+n.pathname;if([r,o,i+"index.html",i,i+n.hash].indexOf(e)>-1)return!0}else{if(l(e))return e(t);if(c(e))for(var u=0;u<e.length;u++)if(!0===C(e[u],t))return!0}}return!1}function P(e,t){if(!e||c(e)&&0===e.length||a(e)&&""===e)return!1;if(a(e)){var n=t.tagName.toLowerCase(),r="."+t.className.split(" ").join("."),o=t.id?"#"+t.id:"";if(n===e.toLowerCase()||r===e||o===e||n+r===e||n+o===e||o+r===e||n+o+r===e)return!0}else if(c(e)){for(var i=0;i<e.length;i++)if(P(e[i],t))return!0}else{if(l(e))return e.call(e,t)||!1;if(s(e)&&e===t)return!0}return!1}function L(e){var t=Jt.trackList,n=e.tagName.toLowerCase(),r=["a","button","input","select","textarea","svg"];function o(){return null!==e.getAttribute("data-ark-click")}var i=e.parentNode;if(i&&i.tagName&&-1===r.indexOf(n))for(;i&&i.tagName;){var a=i.tagName.toLowerCase();if(["button","select","body"].indexOf(a)>-1){n=a;break}i=i.parentNode}if(r.indexOf(n)>-1||o()||P(t,e)){if("svg"===n&&e.children&&e.children.length>0){for(var c=!1,u=e.children,s=0;s<u.length;s++)"use"===u[s].tagName.toLowerCase()&&(u[s].getAttribute("xlink:href")||o()||P(t,e))&&(c=!0);return c}return!0}return!1}var N="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",U=function(e){var t,n,r,o,i,a,c,u="",s=0;for(e=K(e);s<e.length;)o=(t=e.charCodeAt(s++))>>2,i=(3&t)<<4|(n=e.charCodeAt(s++))>>4,a=(15&n)<<2|(r=e.charCodeAt(s++))>>6,c=63&r,isNaN(n)?a=c=64:isNaN(r)&&(c=64),u=u+N.charAt(o)+N.charAt(i)+N.charAt(a)+N.charAt(c);return u},I=function(e){var t,n,r,o,i,a,c="",u=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<e.length;)t=N.indexOf(e.charAt(u++))<<2|(o=N.indexOf(e.charAt(u++)))>>4,n=(15&o)<<4|(i=N.indexOf(e.charAt(u++)))>>2,r=(3&i)<<6|(a=N.indexOf(e.charAt(u++))),c+=String.fromCharCode(t),64!=i&&(c+=String.fromCharCode(n)),64!=a&&(c+=String.fromCharCode(r));return c=F(c)},K=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t},F=function(e){for(var t="",n=0,r=0,o=0,i=0;n<e.length;)(r=e.charCodeAt(n))<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(o=e.charCodeAt(n+1),t+=String.fromCharCode((31&r)<<6|63&o),n+=2):(o=e.charCodeAt(n+1),i=e.charCodeAt(n+2),t+=String.fromCharCode((15&r)<<12|(63&o)<<6|63&i),n+=3);return t},M=window.document;function j(e,t,n){if(n=n||{},void 0!==t){if(null===t&&(t="",n.expires=-1),"number"==typeof n.expires){var r=n.expires,o=n.expires=new Date;o.setTime(o.getTime()+864e5*r)}var i=function(e){try{return n.raw?e:encodeURIComponent(e)}catch(e){}return e};return M.cookie=[i(e),"=",i(t),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}for(var a=null,c=M.cookie,u=c?c.split("; "):[],s=-1,l=u.length,f=e.length+1;++s<l;)if((c=u[s].trim()).substring(0,f)===e+"="){d=c.substring(f),a=n.raw?d:decodeURIComponent(d);break}return a;var d}var V=function(e,t){void 0===e&&(e="FZ_STROAGE");try{var r=(t?n.sessionStorage:n.localStorage).getItem(e);return r?JSON.parse(I(r).replace("ANSAPPID","ARKAPPID").replace("ANS$DEBUG","ARKDEBUG").replace("ANSUPLOADURL","ARKUPLOADURL")):null}catch(e){}},Y=function(e,t,r){void 0===e&&(e="FZ_STROAGE"),void 0===t&&(t=ue());try{(r?n.sessionStorage:n.localStorage).setItem(e,U(JSON.stringify(t)))}catch(e){}},H=function(e){void 0===e&&(e="FZ_STROAGE");var t=j(e);if(t)try{return JSON.parse(I(t))}catch(e){return t}return null},G=function(e,t,n){void 0===e&&(e="FZ_STROAGE"),j(e,null!==t?U(JSON.stringify(t)):null,n)};function J(e){return e?e.split("?")[0]:""}var Z,B=function(){function e(){this.isOpen=!1,this.open()}return e.prototype.open=function(){var e=this,t=window.indexedDB.open("ANALYSYS_AGENT");t.onsuccess=function(n){e.db=t.result,e.onConnectSuccess&&e.onConnectSuccess(e.db),e.isOpen=!0},t.onerror=function(t){e.onConnectError&&e.onConnectError(t)},t.onupgradeneeded=function(e){var t=e.target.result;t.objectStoreNames.contains("FZ_STORAGE")||t.createObjectStore("FZ_STORAGE",{keyPath:"id"})}},e.prototype.getObjectStore=function(){return this.db.transaction("FZ_STORAGE","readwrite").objectStore("FZ_STORAGE")},e.prototype.get=function(e,t){var n=this.db.transaction("FZ_STORAGE").objectStore("FZ_STORAGE").get(1);n.onsuccess=function(t){e&&e(n.result)},n.onerror=function(e){t&&t(e)}},e.prototype.add=function(e,t,n){var r=this.getObjectStore().add(e);r.onsuccess=function(e){t&&t(e)},r.onerror=function(e){n&&n(e)}},e.prototype.delete=function(){this.getObjectStore().delete(1).onsuccess=function(e){}},e.prototype.put=function(e,t,n){var r=this.getObjectStore().put(e);r.onsuccess=function(e){t&&t()},r.onerror=function(e){n&&n()}},e}(),z=function(e){var t=window.location.hostname,n=t.split("/");n.length>2&&(t=n[2]);if(!0===/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/.test(t)||"localhost"===t)return"";var r=t.split("."),o=!0===e?2:r.length;o<2&&(o=2);var i=[];if(!(r.length>1))return"";r.length<o&&(o=r.length);for(var a=r.length-1;a>=0&&i.length!==o;a--)i.push(r[a]);return i.reverse().join(".")}(!0),X=z?"FZ_STROAGE."+z:"",W=new B,q=!1;function Q(){var t=ue();if(Jt.crossSubdomain&&X){var r=e({},t);delete r.ARKSUPER,G(X,r,{expires:7300,domain:z})}n.indexedDB?q?W.put({id:1,content:t}):W.add({id:1,content:t}):Y("FZ_STROAGE",t)}function ee(e,t){function n(e,t){return e<<t|e>>>32-t}function r(e,t){var n,r,o,i,a;return o=2147483648&e,i=2147483648&t,a=(1073741823&e)+(1073741823&t),(n=1073741824&e)&(r=1073741824&t)?2147483648^a^o^i:n|r?1073741824&a?3221225472^a^o^i:1073741824^a^o^i:a^o^i}function o(e,t,o,i,a,c,u){return e=r(e,r(r(function(e,t,n){return e&t|~e&n}(t,o,i),a),u)),r(n(e,c),t)}function i(e,t,o,i,a,c,u){return e=r(e,r(r(function(e,t,n){return e&n|t&~n}(t,o,i),a),u)),r(n(e,c),t)}function a(e,t,o,i,a,c,u){return e=r(e,r(r(function(e,t,n){return e^t^n}(t,o,i),a),u)),r(n(e,c),t)}function c(e,t,o,i,a,c,u){return e=r(e,r(r(function(e,t,n){return t^(e|~n)}(t,o,i),a),u)),r(n(e,c),t)}function u(e){var t,n="",r="";for(t=0;t<=3;t++)n+=(r="0"+(e>>>8*t&255).toString(16)).substr(r.length-2,2);return n}var s,l,f,d,p,g,m,h,v,y;for(s=function(e){for(var t,n=e.length,r=n+8,o=16*((r-r%64)/64+1),i=Array(o-1),a=0,c=0;c<n;)a=c%4*8,i[t=(c-c%4)/4]=i[t]|e.charCodeAt(c)<<a,c++;return a=c%4*8,i[t=(c-c%4)/4]=i[t]|128<<a,i[o-2]=n<<3,i[o-1]=n>>>29,i}(e),m=1732584193,h=4023233417,v=2562383102,y=271733878,l=0;l<s.length;l+=16)f=m,d=h,p=v,g=y,m=o(m,h,v,y,s[l+0],7,3614090360),y=o(y,m,h,v,s[l+1],12,3905402710),v=o(v,y,m,h,s[l+2],17,606105819),h=o(h,v,y,m,s[l+3],22,3250441966),m=o(m,h,v,y,s[l+4],7,4118548399),y=o(y,m,h,v,s[l+5],12,1200080426),v=o(v,y,m,h,s[l+6],17,2821735955),h=o(h,v,y,m,s[l+7],22,4249261313),m=o(m,h,v,y,s[l+8],7,1770035416),y=o(y,m,h,v,s[l+9],12,2336552879),v=o(v,y,m,h,s[l+10],17,4294925233),h=o(h,v,y,m,s[l+11],22,2304563134),m=o(m,h,v,y,s[l+12],7,1804603682),y=o(y,m,h,v,s[l+13],12,4254626195),v=o(v,y,m,h,s[l+14],17,2792965006),m=i(m,h=o(h,v,y,m,s[l+15],22,1236535329),v,y,s[l+1],5,4129170786),y=i(y,m,h,v,s[l+6],9,3225465664),v=i(v,y,m,h,s[l+11],14,643717713),h=i(h,v,y,m,s[l+0],20,3921069994),m=i(m,h,v,y,s[l+5],5,3593408605),y=i(y,m,h,v,s[l+10],9,38016083),v=i(v,y,m,h,s[l+15],14,3634488961),h=i(h,v,y,m,s[l+4],20,3889429448),m=i(m,h,v,y,s[l+9],5,568446438),y=i(y,m,h,v,s[l+14],9,3275163606),v=i(v,y,m,h,s[l+3],14,4107603335),h=i(h,v,y,m,s[l+8],20,1163531501),m=i(m,h,v,y,s[l+13],5,2850285829),y=i(y,m,h,v,s[l+2],9,4243563512),v=i(v,y,m,h,s[l+7],14,1735328473),m=a(m,h=i(h,v,y,m,s[l+12],20,2368359562),v,y,s[l+5],4,4294588738),y=a(y,m,h,v,s[l+8],11,2272392833),v=a(v,y,m,h,s[l+11],16,1839030562),h=a(h,v,y,m,s[l+14],23,4259657740),m=a(m,h,v,y,s[l+1],4,2763975236),y=a(y,m,h,v,s[l+4],11,1272893353),v=a(v,y,m,h,s[l+7],16,4139469664),h=a(h,v,y,m,s[l+10],23,3200236656),m=a(m,h,v,y,s[l+13],4,681279174),y=a(y,m,h,v,s[l+0],11,3936430074),v=a(v,y,m,h,s[l+3],16,3572445317),h=a(h,v,y,m,s[l+6],23,76029189),m=a(m,h,v,y,s[l+9],4,3654602809),y=a(y,m,h,v,s[l+12],11,3873151461),v=a(v,y,m,h,s[l+15],16,530742520),m=c(m,h=a(h,v,y,m,s[l+2],23,3299628645),v,y,s[l+0],6,4096336452),y=c(y,m,h,v,s[l+7],10,1126891415),v=c(v,y,m,h,s[l+14],15,2878612391),h=c(h,v,y,m,s[l+5],21,4237533241),m=c(m,h,v,y,s[l+12],6,1700485571),y=c(y,m,h,v,s[l+3],10,2399980690),v=c(v,y,m,h,s[l+10],15,4293915773),h=c(h,v,y,m,s[l+1],21,2240044497),m=c(m,h,v,y,s[l+8],6,1873313359),y=c(y,m,h,v,s[l+15],10,4264355552),v=c(v,y,m,h,s[l+6],15,2734768916),h=c(h,v,y,m,s[l+13],21,1309151649),m=c(m,h,v,y,s[l+4],6,4149444226),y=c(y,m,h,v,s[l+11],10,3174756917),v=c(v,y,m,h,s[l+2],15,718787259),h=c(h,v,y,m,s[l+9],21,3951481745),m=r(m,f),h=r(h,d),v=r(v,p),y=r(y,g);return 32===t?u(m)+u(h)+u(v)+u(y):u(h)+u(v)}function te(e,t){var n=e.getTimezoneOffset(),r={"M+":(e=new Date(e.getTime()+60*n*1e3+288e5)).getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),"S+":e.getMilliseconds()};for(var o in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),r)new RegExp("("+o+")").test(t)&&(t=t.replace(RegExp.$1,3==RegExp.$1.length?(""+r[o]).length<3?("00"+r[o]).substr(("00"+r[o]).length-3,("00"+r[o]).length):r[o]:("00"+r[o]).substr((""+r[o]).length)));return t}function ne(){Z={STARTUP:!0,STARTUPTIME:te(new Date,"yyyy-MM-dd hh:mm:ss.SSS")},Y("FZ_SESSION",Z,!0)}function re(){Z={},window.sessionStorage.removeItem("FZ_SESSION")}function oe(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++){var o=t[r];if(s(o))for(var i in o)e[i]=o[i]}return e}var ie,ae={utm_campaign_id:"",utm_source:"",utm_medium:"",utm_term:"",utm_content:"",utm_campaign:""};function ce(e){var t,r;function o(){re(),ie={ARKAPPID:Jt.appkey,ARKDEBUG:Jt.debugMode,ARKUPLOADURL:Jt.uploadURL,ARKFRISTPROFILE:"",ARKSUPER:{},ARK_ID:fe(),FRISTDAY:0,POSTDATA:[],SEESIONDATE:0,SEESIONID:""},Q()}t=new URL(decodeURI(window.location.href)).searchParams,ae.utm_campaign_id=t.get("campaign_id")||"",ae.utm_campaign=t.get("utm_campaign")||"",ae.utm_content=t.get("utm_content")||"",ae.utm_medium=t.get("utm_medium")||"",ae.utm_source=t.get("utm_source")||"",ae.utm_term=t.get("utm_term")||"",r=H("ARK_STARTUP")||V("FZ_SESSION",!0)||{},Z=r,function(e){var t=function(){return X?H(X):null},r=V()||t()||null;if(n.indexedDB){var o=function(){W.get((function(n){q=!!n;var o=n?n.content:r;Jt.crossSubdomain?e(t()||o):e(o)}))};W.isOpen?o():W.onConnectSuccess=o}else Jt.crossSubdomain?e(t()||V()||null):e(r)}((function(t){if(t){var r=t.ARKDEBUG;Jt.appkey!==t.ARKAPPID||1===r&&r!==Jt.debugMode?o():ie=t}else o();var i,a;e&&e(),i=H("ARK_ID"),a=H("ARK_STARTUP"),i&&G("ARK_ID",null,{domain:z}),a&&G("ARK_STARTUP",null,{domain:z}),Jt.crossSubdomain||(X?H(X):null)&&G(X,null,{domain:z}),W.isOpen&&n.localStorage.removeItem("FZ_STROAGE")}))}function ue(){return ie}function se(e,t){ie[e]=t,Q()}function le(){return ie.ARK_LOGINID||ie.ARK_TRACKID||ie.ARK_ID}function fe(){var e=(new Date).getTime()+""+1e4*Math.random();return"JS"+ee(e,32)+ee(e,32).slice(0,4)}function de(){var e=+new Date;ie.SEESIONDATE=e,ie.SEESIONID=ee("JS"+e+Math.random(),16),Q()}function pe(t){return t?ie.ARKSUPER[t]:e({},ie.ARKSUPER)}function ge(e){e&&ie.ARKSUPER[e]&&delete ie.ARKSUPER[e],void 0===e&&(ie.ARKSUPER={}),Q()}function me(e){ie.POSTDATA||(ie.POSTDATA=[]),ie.POSTDATA.length<200&&(ie.POSTDATA.push(e),Q())}function he(e){var t={};e.forEach((function(e){t[e.xwhen]=1}));for(var n=ie.POSTDATA.length-1;n>=0;n--){var r=ie.POSTDATA[n];t[r.xwhen]&&ie.POSTDATA.splice(n,1)}Q()}function ve(e){return null==e?"":s(e)?JSON.stringify(e):e+""}function ye(e,t,n){var r=new window.XMLHttpRequest||new window.ActiveXObject("Microsoft.XMLHTTP")||new window.ActiveXObject("Msxml2.XMLHTTP"),o=(e.method||"GET").toUpperCase(),i=e.url,c=e.data,u=oe({},e.header);"GET"===o&&e.data&&(i+=(/\?/.test(e.url)?"&":"?")+function(e){var t=[];for(var n in e){var r=e[n];a(r)?r=encodeURIComponent(e[n]):s(r)&&(r=encodeURIComponent(JSON.stringify(e[n]))),t.push(n+"="+r)}return t.join("&")}(e.data));for(var l in"POST"===o&&e.data&&!u["Content-Type"]&&(c=JSON.stringify(e.data)),r.open(o,i),u)r.setRequestHeader(l,u[l]);r.timeout=e.timeout,r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status){var o={header:(i=r.getAllResponseHeaders(),a=i.trim().split(/[\r\n]+/),c={},a.forEach((function(e){var t=e.split(": "),n=t.shift(),r=t.join(": ");c[n]=r})),c),data:r.responseText};try{o.data=JSON.parse(r.responseText)}catch(e){}t&&t(o,r),e.success&&e.success(o,r)}else n&&n(r),e.error&&e.error(r);var i,a,c},r.send(c)}var _e=0,xe=!1,Se=0;function we(){return+new Date+Se}var Ae=n.AnalysysAgent&&n.AnalysysAgent.param?n.AnalysysAgent.param:[],$e=[];var be=!1,Te=function(){return xe&&Zt&&be};function ke(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(Te())return e.apply(e,n);var o={fn:e,arg:n,xwhen:we()};t?$e.unshift(o):$e.push(o)}}var Ee=!1,Re={};var Oe={$startup:"startUp",$pageview:"pageView",$alias:"alias",page_close:"pageClose",$profile_set_once:"profileSetOnce",$profile_set:"profileSet",$profile_increment:"profileIncrement",$profile_append:"profileAppend",$profile_unset:"profileUnset",$profile_delete:"profileDelete"};function De(e,t,r){var o={functionName:Oe[e]||e,functionParams:t};r&&(o.callbackFunName="nativeCallback"),n.webkit&&n.webkit.messageHandlers&&n.webkit.messageHandlers.AnalysysAgent&&n.webkit.messageHandlers.AnalysysAgent.postMessage&&n.webkit.messageHandlers.AnalysysAgent.postMessage(o),n.AnalysysAgentHybrid&&n.AnalysysAgentHybrid.analysysHybridCallNative&&n.AnalysysAgentHybrid.analysysHybridCallNative(JSON.stringify(o))}function Ce(e,t,n){n&&(Re[e]?Re[e].push(n):Re[e]=[n]),De(e,t?[t]:[],!0)}function Pe(e,t){var n,r=b(e,t);Object.keys(r).length&&(n=r,ie.ARKSUPER=oe({},ie.ARKSUPER,n),Q(),_({fn:t,code:20002,value:e}))}function Le(e,t,n){var r,o="$registerSuperProperty";if(s(e))return Pe(e,o),void(n&&n(pe()));A(e,{code:600023,fn:o,key:e})&&(Pe(((r={})[e]=t,r),o),n&&n(pe()))}function Ne(e,t){Pe(e,"$registerSuperProperties"),t&&t(pe())}function Ue(e,t){if(!Ee){var n=pe(e);return t&&t(n),n}Ce("getSuperProperty",e,t)}function Ie(e){if(!Ee){var t=pe();return e&&e(t),t}Ce("getSuperProperties",null,e)}function Ke(e,t){ge(e),_({fn:"$unRegisterSuperProperty",code:20003,value:e}),t&&t(pe())}function Fe(e){ge(),_({fn:"$clearSuperProperties",code:20004}),e&&e(pe())}function Me(e,t,n){var r=new Image(1,1),o=null;function i(){r.src="",r.onload=null,r.onerror=null,r.onabort=null}function a(){clearTimeout(o),t&&t({header:{},data:{code:200}}),i()}r.crossOrigin="anonymous",r.onload=function(){a()},r.onerror=function(e,t){a()},r.onabort=function(){i(),n&&n()};var c=e.url;if(e.data){var u=function(e,t){var n={data:e,send_type:""},r=[];for(var o in n)r.push(o+"="+encodeURIComponent(n[o]));var i=t+"&"+r.join("&"),a="/"!==Jt.uploadURL[Jt.uploadURL.length-1]?Jt.uploadURL:Jt.uploadURL.substring(0,Jt.uploadURL.length-1),c=ee(i=i.replace(a,""),32).split(""),u=c[2]+""+c[0]+c[4];return n.send_type=u,n}(U(e.data),c);c+="&data="+encodeURIComponent(u.data)+"&send_type="+encodeURIComponent(u.send_type)}o=setTimeout((function(){r.onabort()}),Jt.sendDataTimeout),r.src=c}var je={startup:{state:!1,xwhen:0},pageview:{xwhen:0,state:{},prevPath:document.referrer,path:document.location.href},webstay:{xwhen:0},isUnload:!1,eventCallback:{},pageClose:{hideTime:0,hideStartTime:0},timeEvent:{}};function Ve(e){je.eventCallback[e.xwhen]&&(je.eventCallback[e.xwhen](e),delete je.eventCallback[e.xwhen])}var Ye=[],He=0;function Ge(){var e=t(ie.POSTDATA);if(!Ye.length&&e.length){Ye=e.splice(0,20);var r={url:Jt.uploadURL+"up?appid="+Jt.appkey,data:Ye,encryptType:Jt.encryptType};if(_({key:r.url,value:Ye,code:20012}),1===Jt.debugMode)return he(Ye),void(Ye=[]);n.AnalysysModal&&"function"==typeof n.AnalysysModal&&n.AnalysysModal(r.data),ye({url:r.url,method:"POST",data:r.data,timeout:Jt.sendDataTimeout},(function(){Ye.forEach((function(e){Ve(e),Nt("successSend",e)})),he(Ye),Ye=[],Ge(),_({code:20001}),He=0}),(function(){Ye=[],x({code:60008}),He<3&&(Ge(),He++)}))}}function Je(t,n,r){var o=t.xwhat;if(Ee&&-1===["$web_click","$webstay","$user_click"].indexOf(o)){["$is_first_day","$session_id","$is_time_calibrated","$startup_time","$lib","$lib_version","$platform","$debug","$is_login"].forEach((function(e){delete t.xcontext[e]}));var i=[t.xcontext];return"$pageview"===o&&i.unshift(t.xcontext.$title||""),r&&i.unshift(o),void De(r?"track":o,i)}if(n&&l(n)&&(je.eventCallback[t.xwhen]=n),Nt("afterSend",e(e({},t),{xcontext:e({},t.xcontext)})),je.isUnload&&navigator&&navigator.sendBeacon){var a={url:Jt.uploadURL+"up?appid="+Jt.appkey,data:[t]};return function(e){var t=e.url,n=JSON.stringify(e.data);navigator.sendBeacon(t,n)}(a),void _({key:a.url,value:a.data,code:20012})}"img"===Jt.sendType?function(e){var t={url:Jt.uploadURL+"up?appid="+Jt.appkey,data:JSON.stringify([e])};_({key:t.url,value:[e],code:20012}),Me(t,(function(){_({code:20001}),Ve(e),Nt("successSend",e)}),(function(){x({code:60008}),me(e),Ge()}))}(t):(me(t),Ge())}const Ze=(We="String",e=>Object.prototype.toString.call(e)===`[object ${We}]`),Be=e=>e instanceof HTMLElement,ze=(e,t,n)=>{const r=Object.assign({},n);let o=0;if(Be(e)||(e=>e instanceof SVGElement)(e))for(;e.parentNode;){if(t(e,o))return e;if(o++,e=e.parentNode,r.root&&e===r.root){t&&t(e,o);break}}},Xe=(e,t)=>e&&e.getAttribute?e.getAttribute(t):null;var We;function qe(e,t){var n=document.defaultView;return n&&n.getComputedStyle?document.defaultView.getComputedStyle(e,null)[t]:e.currentStyle[t]}function Qe(e,t){var n,r,o,i;if(e){if(a(t))return qe(e,t);if(c(t)){for(o={},i=0,n=t.length;i<n;i++)o[r=t[i]]=qe(e,r);return o}}}function et(e){var t,n="",r=e.tagName.toLowerCase();return n="input"===r&&["button","submit"].indexOf(e.type)>-1?e.value||"":"img"===r?Xe(e,"alt")||Xe(e,"title")||"":e.textContent,a(t=n)&&t.length>255?t.slice(0,254)+"$":t}var tt={},nt={};function rt(e){tt.element_id=e.id,tt.element_content=et(e),tt.element_type=e.tagName.toLowerCase(),tt.element_name=Xe(e,"name"),tt.element_class_name=Xe(e,"class"),tt.element_target_url=function(e){var t=e.getAttribute("href");if(t&&t.indexOf("javascript:")<0){try{t=decodeURIComponent(t)}catch(e){}return t}return""}(e),tt.element_path=((e,t)=>{const n=Object.assign({full:!1,mode:"loose",endTag:[]},t);let r="";return ze(e,e=>{const t=e.id,o=e.tagName.toLowerCase();let i="";if(n.endTag.indexOf(o)>-1&&(r=""),Be(e)){if(t&&!n.full)i=`//${o}[@id="${t}"]`;else{const t=e.parentNode?Array.from(e.parentNode.children).filter(t=>{const r=t.tagName===e.tagName,o=t.className;if(o&&Ze(o)){if("ordinary"===n.mode)return r&&o.indexOf(e.classList[0])>-1;if("strict"===n.mode)return r&&o===e.className}return r}):[],r=t.length>1?`[${t.indexOf(e)+1}]`:"";let a="";"ordinary"===n.mode&&e.classList[0]&&(a=`[contains(@class,"${e.classList[0]}")]`),"strict"===n.mode&&e.className&&(a=`[@class="${e.className}"]`),i=`/${o}${a}${r}`}r=i+r}if(!n.full&&t)return!0}),r})(e,{endTag:["button"]})}function ot(e){var t=document.documentElement.scrollLeft||document.body.scrollLeft,n=document.documentElement.scrollTop||document.body.scrollTop,r=e.pageX||e.clientX+t,o=e.pageY||e.clientY+n,i=e.target||e.srcElement;nt.click_x=r,nt.click_y=o;var a=function(e){for(var t=0,n=0;null!==e&&e!==document.body;)1===e.nodeType&&(t+=e.scrollTop,n+=e.scrollLeft),e=e.parentNode;return{scrollLeft:n,scrollTop:t}}(i),c=function(e){for(var t=0,n=0,r=!1,o=!1;null!=e;)void 0!==e.offsetTop?(t+=e.offsetTop,n+=e.offsetLeft,r||(r=!("none"!==Qe(e,"display")&&"0px"!==Qe(e,"width")&&"0px"!==Qe(e,"height"))),"fixed"===Qe(e,"position")&&(o=!0),e=e.offsetParent):e=e.parentNode;return!0===o&&(t+=document.documentElement.scrollTop||document.body.scrollTop,n+=document.documentElement.scrollLeft||document.body.scrollLeft),{top:t,left:n,hidden:r}}(i);nt.element_x=r-(c.left-a.scrollLeft),nt.element_y=o-(c.top-a.scrollTop),nt.element_clickable=L(i)?1:0}function it(){var e=n.navigator.userAgent;return e.indexOf("Tablet")>-1&&e.indexOf("PC")<0||e.indexOf("Pad")>-1||e.indexOf("Nexus 7")>-1?"tablet":e.indexOf("Mobi")>-1||e.indexOf("iPh")>-1||e.indexOf("480")>-1?"phone":"desktop"}function at(e,t){var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=t;var r=document.getElementsByTagName("body")[0]||document.getElementsByTagName("head")[0];r&&r.appendChild(n)}var ct={xwho:function(){return le()},xwhen:function(){return we()},xwhat:function(e){return e},$lib:function(){return"JS"},$lib_version:function(){return"5.0.5"},$platform:function(){return"JS"},$debug:function(){return Jt.debugMode},$is_login:function(){return!!ie.ARK_LOGINID},$session_id:function(){return e=new Date,t=e.getTime(),n=e.getTimezoneOffset(),r=function(e){return new Date(e+60*n*1e3+288e5).getDate()},o=ie.SEESIONDATE,(!ie.SEESIONID||!o||t-o>18e5||r(t)!==r(o))&&de(),ie.SEESIONID;var e,t,n,r,o},$screen_width:function(){return n.screen.width||0},$screen_height:function(){return n.screen.height||0},$language:function(){return(n.navigator.language||n.navigator.browserLanguage).toLowerCase()},$user_agent:function(){return n.navigator.userAgent.replace(/"/g,'\\"')},$time_zone:function(){return"GMT"+(e=(new Date).getTimezoneOffset(),n=e%60,r="-",((t=e/60)<=0||n<0)&&(r="+",t=-t,n<0&&(n=-n)),1==(t+="").length&&(t="0"+t),1==(n+="").length&&(n="0"+n),r+t+":"+n);var e,t,n,r},$startup_time:function(){return Z.STARTUPTIME},$is_first_time:function(){return!ie.FRISTDAY},$is_first_day:function(){return!ie.FRISTDAY||(a(ie.FRISTDAY)?te(new Date(we()),"yyyyMMdd")===ie.FRISTDAY:!!i(ie.FRISTDAY)&&te(new Date(we()),"yyyyMMdd")===te(new Date(ie.FRISTDAY),"yyyyMMdd"))},$first_visit_time:function(){return ie.ARKFRISTPROFILE},$first_visit_language:function(){return(navigator.language||navigator.browserLanguage).toLowerCase()},$original_id:function(){return ie.ARK_TRACKID||ie.ARK_ID},$is_time_calibrated:function(){return!(!Jt.allowTimeCheck||!Se)},$referrer:function(){return je.pageview.prevPath},$referrer_domain:function(){return J(je.pageview.prevPath)},$title:function(){return document.title},$url:function(){return je.pageview.path},$url_path:function(){return J(je.pageview.path)},$url_domain:function(){return J(je.pageview.path)},$utm_campaign_id:function(){return ae.utm_campaign_id},$utm_source:function(){return ae.utm_source},$utm_medium:function(){return ae.utm_medium},$utm_term:function(){return ae.utm_term},$utm_content:function(){return ae.utm_content},$utm_campaign:function(){return ae.utm_campaign},$element_content:function(){return ve(tt.element_content)},$element_id:function(){return ve(tt.element_id)},$element_type:function(){return ve(tt.element_type)},$element_name:function(){return ve(tt.element_name)},$element_class_name:function(){return ve(tt.element_class_name)},$element_target_url:function(){return ve(tt.element_target_url)},$element_path:function(){return ve(tt.element_path)},$page_width:function(){return document.documentElement.scrollWidth},$page_height:function(){return document.documentElement.scrollHeight},$click_x:function(){return nt.click_x},$click_y:function(){return nt.click_y},$element_x:function(){return nt.element_x},$element_y:function(){return nt.element_y},$element_clickable:function(){return nt.element_clickable},$viewport_width:function(){return document.documentElement.clientWidth||document.body.clientWidth},$viewport_height:function(){return document.documentElement.clientHeight||document.body.clientHeight},$viewport_position:function(){return document.documentElement.scrollTop||document.body.scrollTop},$event_duration:function(){var e=+new Date-(je.webstay.xwhen||je.pageview.xwhen);return e>Jt.webstayDuration?Jt.webstayDuration:e},$device_type:function(){return it()},$web_crawler:function(){return!!navigator.userAgent.toLowerCase().match(/(bot|crawler|spider|scrapy|dnspod|ia_archiver|jiankongbao|slurp|transcoder|networkbench|oneapm|PhantomJS|BingPreview)/i)}};function ut(e){var t={appid:Jt.appkey,xwho:ct.xwho(),xwhat:ct.xwhat(e),xwhen:ct.xwhen(),xcontext:{}},n=m[e];function r(e){var n=ct[e];if(n){var r=n();""!==r&&null!=r&&(t.xcontext[e]=r)}}return d.forEach((function(e){r(e)})),n&&n.forEach((function(e){r(e)})),t}var st={};function lt(e){st=oe({},st,e)}function ft(){return st}function dt(t,r,o){if(!C(Jt.pageViewBlackList)){var i={},a={};w(t)&&(i.$title=t,r&&(a=b(r,"$pageview"))),i=oe({},a,i);var c=ut("$pageview");je.webstay.xwhen=0,je.pageview.xwhen=c.xwhen,c.xcontext=oe({},c.xcontext,pe(),ft(),i);var u=Jt.beforePageView;if(u){var s=e(e({},c),{xcontext:e({},c.xcontext)});if(!1===u.call(n.AnalysysAgent,s,(function(e){var t=b(e,"$pageview");return c.xcontext=oe({},c.xcontext,t),c.xcontext})))return c}return je.pageview.$title=c.xcontext.$title,Je(c,o),c}}function pt(){var t=ut("page_close");if(!t.xcontext||t.xcontext.$url){var r,o,i=t.xwhen-je.pageview.xwhen-(r=je.pageClose,o=r.hideTime,r.hideStartTime?o+(t.xwhen-r.hideStartTime):o),a={pagestaytime:i>0?i:t.xwhen-je.pageview.xwhen},c=je.pageview.$title;c&&(a.$title=c),t.xcontext=oe({},t.xcontext,pe(),ft(),a),st={},je.pageClose.hideStartTime=0,je.pageClose.hideTime=0;var u=Jt.beforePageClose;if(u){var s=e(e({},t),{xcontext:e({},t.xcontext)});if(!1===u.call(n.AnalysysAgent,s,(function(e){var n=b(e,"page_close");return t.xcontext=oe({},t.xcontext,n),t.xcontext})))return t}Je(t)}}function gt(){Jt.autoPageViewDuration&&je.pageview.xwhen&&pt(),je.pageview.prevPath=je.pageview.path,je.pageview.path=document.location.href}function mt(e,t,n,r){var o=ut(e);p.forEach((function(e){o.xcontext[e]&&delete o.xcontext[e]}));var i={};s(t)&&(i=t),w(t)&&$(n)&&(i[t]=n),o.xcontext=oe({},o.xcontext,b(i,e));var a=r||null;l(n)&&!r&&(a=n),Je(o,a)}function ht(e,t,n){mt("$profile_set_once",e,t,n)}function vt(e,t,n){mt("$profile_set",e,t,n)}function yt(e,t,n){mt("$profile_increment",e,t,n)}function _t(e,t,n){mt("$profile_append",e,t,n)}function xt(e,t){var n,r=ut("$profile_unset");p.forEach((function(e){r.xcontext[e]&&delete r.xcontext[e]})),A(e)?r.xcontext=oe({},r.xcontext,((n={})[e]="",n)):x({code:600010,fn:"profileUnset",key:e}),Je(r,t)}function St(e){var t=ut("$profile_delete");p.forEach((function(e){t.xcontext[e]&&delete t.xcontext[e]})),Je(t,e)}function wt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ut("$startup");ie.ARKFRISTPROFILE||(se("ARKFRISTPROFILE",te(new Date(n.xwhen),"yyyy-MM-dd hh:mm:ss.SSS")),Jt.autoProfile&&ht()),Z.STARTUP||(ne(),n.xcontext=oe({},n.xcontext,pe()),je.startup.xwhen=n.xwhen,Je(n))}function At(e,t){if(!w(e))return x({code:60005,value:e,fn:"alias"}),!1;if(e===le())return _({code:20014}),void(t&&l(t)&&t());se("ARK_LOGINID",e),_({code:20014});var n=ut("$alias");p.forEach((function(e){n.xcontext[e]&&delete n.xcontext[e]})),!0===Jt.autoProfile?(Je(n,t),ht()):Je(n,t)}function $t(e){rt(e.target||e.srcElement),ot(e);var t=ut("$web_click");t.xcontext=oe({},t.xcontext),Je(t)}function bt(e){ie.ARK_ID=fe(),ie.ARK_TRACKID="",ie.ARK_LOGINID="",ie.ARKSUPER={},ie.ARKFRISTPROFILE="",de(),re(),!0===Jt.autoProfile&&ht({$reset_time:te(new Date,"yyyy-MM-dd hh:mm:ss.SSS")}),_({fn:"$reset",code:20005}),e&&e()}function Tt(e){var t=ut("$getPresetProperties");return delete t.xcontext.$is_login,_({code:20010,fn:"getPresetProperties",value:t.xcontext}),e&&e(t.xcontext),t.xcontext}function kt(t,r,o){if(/^[a-zA-Z$][a-zA-Z0-9_]{1,99}$|^[a-zA-Z]$/.test(t)){var i=ut("track"),a=r&&!l(r)?b(r,t):{};je.timeEvent[t]&&(a.$duration=we()-je.timeEvent[t],delete je[t]),i.xwhat=t,i.xcontext=oe({},i.xcontext,pe(),a);var c=o||null;l(r)&&!o&&(c=r);var u=Jt.beforeTrack;if(u){var s=e(e({},i),{xcontext:e({},i.xcontext)});if(!1===u.call(n.AnalysysAgent,s,(function(e){var n=b(e,t);return i.xcontext=oe({},i.xcontext,n),i.xcontext})))return i}return Je(i,c,!0),i}x({code:600025,fn:"track",value:t})}function Et(e){je.timeEvent[e]=we()}function Rt(e,t){var r;w(e)?(r=e,ie.ARK_TRACKID=r,Q(),_({code:20002,value:e,fn:"identify"}),t&&t(),n.AnalysysModal&&n.AnalysysModal([{xwhat:"$identify",xwho:e}])):x({code:60009,fn:"identify",value:e})}function Ot(e){if(!Ee){var t=ie.ARK_TRACKID||ie.ARK_ID;return e&&e(t),t}Ce("getDistinctId",null,e)}function Dt(e){var t=b(e,"$pageProperty");lt(t),Object.keys(t).length&&_({fn:"$pageProperty",code:20002,value:e})}function Ct(e,t){var n=Re[e];n&&(n.forEach((function(e){e(t)})),Re[e]=[])}document.hidden&&(je.pageClose.hideStartTime=+new Date);var Pt={};function Lt(e,t){Pt[e]?Pt[e].push(t):Pt[e]=[t]}function Nt(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];Pt[e]&&Pt[e].forEach((function(e){e.apply(void 0,t)}))}function Ut(e){return e&&e.tagName&&e.tagName.toLowerCase()||""}function It(e){var t=function(e){var t=function(e){return e.parentNode}(e);return t?t.children:null}(e);if(t)for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}var Kt=null,Ft=n.location.href;var Mt=null;function jt(){var e;Jt.auto?ke(dt)():(je.webstay.xwhen=0,je.pageview.xwhen=+new Date),Ee&&De("getHybirdWebURL",[{url:document.location.href}]),(e=Jt.visitorConfigURL)&&-1===Ft.indexOf("arkheatmap=true")&&-1===Ft.indexOf("visual=true")&&ye({url:e+"configure",data:{appkey:Jt.appkey,lib:"Js",url:window.location.href},timeout:Jt.getDataTimeout},(function(e){var t=e.data.data;t&&t.length?(S("Get Visual Event List from app"),S(JSON.stringify(t,null,2)),Kt={},t.forEach((function(e){for(var t="",n=e.new_path.length-3;n>=0;n--){var r=e.new_path[n];t+=r.tagName+(r.id?"#"+r.id:"")+(void 0===r.row||r.id?"":r.row)}Kt[t]=e}))):Kt=null}))}function Vt(){!Ee&&Jt.autoStartUp&&wt(),jt(),Jt.hash&&function(e){var t=window.history.pushState,n=window.history.replaceState;window.history.pushState=function(){var n=arguments;t.apply(window.history,n),setTimeout((function(){e&&e(n)}))},window.history.replaceState=function(t){var r=arguments;n.apply(window.history,r),setTimeout((function(){e&&e(r)}))};var r=t?"popstate":"hashchange";window.addEventListener(r,(function(){var t=arguments;setTimeout((function(){e&&e(t)}))}))}((function(){je.pageview.path!==document.location.href&&(gt(),jt())}));var e="onpageshow"in n?"pagehide":"beforeunload";n.addEventListener(e,(function(){je.isUnload=!0,gt()}));var t=it();if(Jt.autoTrack||Jt.visitorConfigURL){var r="desktop"===t?"mousedown":"touchstart";document.addEventListener(r,(function(e){!function(e){if(Jt.autoTrack){var t=e.target||e.srcElement;if(!C(Jt.autoClickBlackList,t)&&L(t)){var n=Jt.userClickProperty,r={};if(s(n))for(var o in n){var i=n[o];l(i)?r[o]=i.call(i,t):r[o]=i}else l(n)&&(r=n.call(n,t));var c=t.getAttribute("data-ark-click")||{};if(a(c))try{c=JSON.parse(c)}catch(e){}s(c)||(c={}),rt(t);var u=ut("$user_click");u.xcontext=oe({},u.xcontext,pe(),r,c),Je(u)}}}(e),function(e){if(!Kt)return!1;var t=[];!function(e,t){for(;e;){if("break"===(t&&t(e)))break;e=e.parentNode}}(e.target||e.srcElement,(function(e){if(t.push(e),"body"===Ut(e))return"break"}));var n=t.length-2;function r(e){for(var r="",o="",i=n;i>=e;i--){var a=t[i],c=Ut(t[i]);if(c){var u=c+(a.id?"#"+a.id:"");if(r+=u,o+=u,"html"===c||"body"===c||a.id||(o+=""+It(a)),"button"===c)break}}return{path:r,pathIndex:o}}for(var o=[],i=0;i<n;i++){var a=r(i),c=a.path,u=a.pathIndex;o.push(c,u)}var s={};o.forEach((function(e){var t=Kt[e];t&&!s[t.appEventId]&&(s[t.appEventId]=t)}));var l=function(e){var t={};s[e].properties.forEach((function(e){t[e.key]=e.value})),kt(e,t)};for(var f in s)l(f)}(e)}))}var o=n.location.href,i=Jt.SDKFileDirectory||"/sdk/";Jt.autoHeatmap&&(-1===o.indexOf("arkheatmap=true")?-1===o.indexOf("visual=true")&&(document.addEventListener("click",$t),document.addEventListener("scroll",(function(){clearTimeout(Mt),Mt=setTimeout((function(){var e;(e=ut("$webstay")).xcontext=oe({},e.xcontext),je.webstay.xwhen=e.xwhen,Je(e)}),1e3)}))):at(i+"AnalysysAgent_JS_SDK_HEATMAP.min.js")),"onvisibilitychange"in document&&Jt.autoPageViewDuration&&document.addEventListener("visibilitychange",(function(){document.hidden?je.pageClose.hideStartTime=+new Date:(je.pageClose.hideTime=je.pageClose.hideTime+(+new Date-je.pageClose.hideStartTime),je.pageClose.hideStartTime=0)}))}function Yt(e){if(a(e))return!0;if(l(e))return!0;if(c(e)){for(var t=0;t<e.length;t++){var n=e[t];if(!a(n)&&!l(n))return!1}return!0}}var Ht,Gt={appkey:{ck:[O]},uploadURL:{ck:[O]},debugMode:{ck:[R]},name:{ck:[O]},autoStartUp:{ck:[k]},auto:{ck:[k]},autoProfile:{ck:[k]},encryptType:{ck:[R]},hash:{ck:[k]},allowTimeCheck:{ck:[k]},maxDiffTimeInterval:{ck:[R,function(e){return!(e<=0)}]},autoTrack:{ck:[k]},trackList:{ck:[Yt]},autoCompleteURL:{ck:[k]},autoPageViewDuration:{ck:[k]},sendDataTimeout:{ck:[R]},sendType:{ck:[O]},autoClickBlackList:{ck:[Yt]},autoHeatmap:{ck:[k]},SDKFileDirectory:{ck:[O]},visitorConfigURL:{ck:[O]},crossSubdomain:{ck:[k]},pageProperty:{ck:[D]},pageViewBlackList:{ck:[Yt]},userClickProperty:{ck:[D]},exposure:{ck:[D]},beforeTrack:{ck:[E]},beforePageView:{ck:[E]},beforePageClose:{ck:[E]},beforeInit:{ck:[E]}},Jt={appkey:"",uploadURL:"",debugMode:0,visitorConfigURL:"",name:"",autoStartUp:!0,auto:!0,SDKFileDirectory:"",autoTrack:!1,autoClickBlackList:"",userClickProperty:{},trackList:[],autoHeatmap:!1,autoWebstay:!0,webstayDuration:18e6,autoProfile:!0,hash:!0,encryptType:0,allowTimeCheck:!1,maxDiffTimeInterval:30,autoPageViewDuration:!1,sendDataTimeout:1e4,getDataTimeout:1e4,sendType:"img",crossSubdomain:!1},Zt=!1;function Bt(t,r){function o(){Te()&&(_({code:20007}),Ae&&Ae.length&&(Ae.forEach((function(e){var t=n.AnalysysAgent[e.fn];t&&t.apply(void 0,e.arg)})),Ae=null),$e&&$e.length&&($e.forEach((function(e){e.fn.apply(e.fn,e.arg)})),$e=[]),Vt(),Nt("afterInit",e({},Jt)),r&&r(Jt))}Object.keys(t).forEach((function(e){var n=Gt[e];if(n&&n.ck.length){for(var r=t[e],o=!0,i=0;i<n.ck.length;i++){if(!(0,n.ck[i])(r,e)){o=!1;break}}o&&("uploadURL"!==e&&"SDKFileDirectory"!==e&&"visitorConfigURL"!==e||r&&"/"!==r[r.length-1]&&(r+="/"),"pageProperty"===e&&r&&lt(r),Jt[e]=r)}})),Ft.indexOf("visual=true")>-1&&Jt.visitorConfigURL&&at((Jt.SDKFileDirectory||"/sdk/")+"AnalysysAgent_JS_SDK_VISUAL.min.js"),function(t){function r(){be||(be=!0,t())}var o=Jt.beforeInit;if(o){var i=o.call(n.AnalysysAgent,e({},Jt),r);(i instanceof Promise||i&&l(i.then))&&i.then((function(){r()}))}else r()}(o),function(e){if(!Jt.allowTimeCheck||_e)return xe=!0,void(e&&e(_e));ye({url:Jt.uploadURL,timeout:800},(function(t){if(t&&t.header&&t.header.date){var n=+new Date;_e=+new Date(t.header.date);var r=Math.abs((_e-n)/1e3);r>Jt.maxDiffTimeInterval&&(Se=_e-n,_({code:20013,value:te(new Date(_e),"yyyy-MM-dd hh:mm:ss +SSS"),key:te(new Date(n),"yyyy-MM-dd hh:mm:ss +SSS"),fn:r+"s"}))}xe=!0,e&&e(_e)}),(function(){xe=!0,e&&e(_e)}))}(o),ce((function(){Zt=!0,o()}))}(Ht=n.AnalysysAgentHybrid)&&Ht.isHybrid&&(Ee=Ht.isHybrid());var zt=new(function(){function e(){this.isInit=!1,this.isHybrid=Ee,this.config=Jt,this.appStart=ke(wt),this.pageView=ke(dt),this.registerSuperProperty=ke(Le,!0),this.registerSuperProperties=ke(Ne,!0),this.getSuperProperty=ke(Ue),this.getSuperProperties=ke(Ie),this.unRegisterSuperProperty=ke(Ke),this.clearSuperProperties=ke(Fe),this.profileSetOnce=ke(ht),this.profileSet=ke(vt),this.profileAppend=ke(_t),this.profileIncrement=ke(yt),this.profileDelete=ke(St),this.profileUnset=ke(xt),this.reset=ke(bt),this.track=ke(kt),this.timeEvent=Et,this.alias=ke(At),this.getPresetProperties=ke(Tt),this.identify=ke(Rt),this.getDistinctId=ke(Ot),this.pageProperty=ke(Dt),this.nativeCallback=Ct,this.on=Lt}return e.prototype.init=function(e){var t=this;if(!e.appkey)throw v[60006];if(!e.uploadURL)throw v[60007];Bt(e,(function(e){t.config.name&&(n[t.config.name]=n.AnalysysAgent),t.isInit=!0}))},e}());n.AnalysysAgent=zt;export default zt;
